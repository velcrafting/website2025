/* Tailwind v4 */
@import "tailwindcss";
@plugin "@tailwindcss/typography";
@import "katex/dist/katex.min.css";

/* ====== Tokens ====== */
:root {
  /* Dark defaults */
  --background: #141414;     /* page bg */
  --surface:    #111111;     /* panels/rail/cards */
  --foreground: #e7e7e7;     /* primary text */
  --muted:      #9a9a9a;     /* secondary text */
  --radius:     16px;        /* rounded-2xl vibe */

  /* Next/font variables */
  --font-sans: var(--font-geist-sans);
  --font-mono: var(--font-geist-mono);

  /* rings and borders */
  --border:     34 34 34;    /* rgb triplet for borders */
  --ring:       255 255 255; /* focus ring in dark */
}

/* Map tokens to Tailwind theme variables */
@theme inline {
  --color-background: var(--background);
  --color-surface:    var(--surface);
  --color-foreground: var(--foreground);
  --color-muted:      var(--muted);
  --radius:           var(--radius);

  --font-sans: var(--font-sans);
  --font-mono: var(--font-mono);
}

/* Optional: follow userâ€™s system preference as a default.
   You can still force light by adding .light to <html>. */
@media (prefers-color-scheme: light) {
  :root {
    --background: #fafafa;
    --surface:    #ffffff;
    --foreground: #171717;
    --muted:      #5f5f5f;
    --ring:       17 17 17;
    --border:     224 224 224;
  }
  html { color-scheme: light; }
}

/* ====== Global base ====== */
html, body { height: 100%; }
html { color-scheme: dark; }
body {
  font-family: var(--font-sans), ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;

  background:
    radial-gradient(1200px 600px at 75% 0%, rgba(255,255,255,0.06), transparent 60%),
    radial-gradient(900px 500px at 10% 0%, rgba(255,255,255,0.04), transparent 60%),
    var(--background);
  color: var(--foreground);
}

/* Light theme override via class on <html> */
html.light {
  color-scheme: light;
  --background: #fafafa;
  --surface:    #ffffff;
  --foreground: #171717;
  --muted:      #5f5f5f;
  --ring:       17 17 17;
  --border:     224 224 224;
}
html.light body {
  background:
    radial-gradient(1200px 600px at 75% 0%, rgba(0,0,0,0.05), transparent 60%),
    radial-gradient(900px 500px at 10% 0%, rgba(0,0,0,0.04), transparent 60%),
    var(--background);
}

/* Dark theme override via class on <html> */
html.dark {
  color-scheme: dark;
  --background: #141414;
  --surface:    #111111;
  --foreground: #e7e7e7;
  --muted:      #9a9a9a;
  --ring:       255 255 255;
  --border:     34 34 34;
}

/* ====== App chrome ====== */
.app-shell {        /* full-viewport frame with padding and soft bg bloom */
  @apply min-h-dvh p-4 md:p-6;
}

.panel {            /* main rounded container */
  @apply mx-auto w-full overflow-hidden rounded-2xl shadow-sm;
  background-color: color-mix(in oklab, var(--surface) 92%, transparent);
  border: 1px solid rgb(var(--border) / 0.8);
  backdrop-filter: blur(1px);
}

.rail {             /* left navigation rail */
  background-color: color-mix(in oklab, var(--surface) 95%, transparent);
  border-right: 1px solid rgb(var(--border) / 0.85);
}

/* ====== Typography ====== */
h1, h2, h3 { @apply tracking-tight; }
h1 { @apply text-neutral-100; }
h2, h3 { @apply text-neutral-100; }
p  { @apply text-neutral-300; }

.lead {             /* subheadline under H1 */
  @apply text-lg text-neutral-400 max-w-3xl;
}

a {
  @apply text-neutral-200 no-underline;
  transition: opacity .15s ease, color .15s ease, background-color .15s ease, border-color .15s ease;
}
a:hover { @apply text-white; }

/* prose typography handled in src/styles/prose.css */

/* ====== Components ====== */
.btn {
  @apply inline-flex items-center justify-center rounded-xl px-4 py-2 text-sm;
  border: 1px solid rgb(var(--border) / 0.85);
  background-color: color-mix(in oklab, var(--surface) 92%, transparent);
}
.btn:hover {
  @apply bg-white/5;
}
html.light .btn:hover {
  @apply bg-neutral-100;
}

.metric {           /* KPI card */
  @apply rounded-xl p-4 shadow-sm;
  border: 1px solid rgb(var(--border) / 0.85);
  background-color: color-mix(in oklab, var(--surface) 92%, transparent);
}
.metric .value { @apply text-3xl font-semibold text-neutral-100; }
.metric .label { @apply mt-2 text-sm text-neutral-400; }

/* Avatar ring */
.avatar {
  @apply h-16 w-16 rounded-full ring-1 ring-white/10;
}

/* Focus styles */
:where(a, button, [role="button"], .btn):focus-visible {
  outline: 2px solid rgb(var(--ring));
  outline-offset: 2px;
}

/* ====== Light theme component overrides ====== */
html.light h1, html.light h2, html.light h3 { @apply text-neutral-900; }
html.light p  { @apply text-neutral-700; }
html.light a  { @apply text-neutral-900; }
html.light a:hover { @apply text-black; }

html.light .panel { @apply bg-white; border-color: rgb(var(--border)); }
html.light .rail  { @apply bg-neutral-50; border-color: rgb(var(--border)); }
html.light .metric { @apply bg-white; border-color: rgb(var(--border)); }
/* prose light theme handled in src/styles/prose.css */

/* ====== Helpful defaults ====== */
.container-narrow { @apply mx-auto w-full max-w-6xl; }
.section-gap { @apply mt-10 md:mt-12; }

/* ====== Scrollbar polish (WebKit) ====== */
::-webkit-scrollbar { width: 8px; height: 8px; }
::-webkit-scrollbar-thumb { background-color: rgba(120,120,120,.35); border-radius: 4px; }
::-webkit-scrollbar-thumb:hover { background-color: rgba(160,160,160,.55); }

/* ====== Animated rainbow utility for icons ====== */
@keyframes huerotate {
  from { filter: hue-rotate(0deg); }
  to   { filter: hue-rotate(360deg); }
}

/* Force icon stroke/fill to follow CSS variables, overriding SVG attributes */
.gradient-icon svg *,
.gradient-icon svg {
  stroke: var(--icon-stroke, currentColor) !important;
  fill: var(--icon-fill, none) !important;
}

/* Card hover gradient border (subtle) */
.card-hover-gradient::before {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: 1rem; /* match rounded-2xl */
  padding: 1px; /* border thickness */
  background: linear-gradient(135deg, #ef4444, #f59e0b, #10b981, #3b82f6, #8b5cf6);
  -webkit-mask: 
    linear-gradient(#000 0 0) content-box, 
    linear-gradient(#000 0 0);
  -webkit-mask-composite: xor;
          mask-composite: exclude;
  opacity: 0;
  transition: opacity .2s ease;
  pointer-events: none;
}
.card-hover-gradient:hover::before { opacity: 0.9; }
